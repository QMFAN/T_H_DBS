## 清理清单
- `backend/src/entities/import-conflict.entity.ts`
  - 原因：空文件、零引用；已被 `ImportAnomaly` 体系替代（迁移脚本见 `backend/database/migrations/001_rename_conflicts_to_anomalies.sql`）。
- `backend/dist/**`
  - 原因：陈旧构建产物（含 `entities/import-conflict.entity.*` 等与源码不一致的文件）；应通过构建再生成。
- `frontend/src/typescript.svg`
  - 原因：未被任何代码引用。
- `backend/src/app.controller.ts` 与 `backend/src/app.service.ts`
  - 原因：样板根端点 `GET /` 未被前端或业务使用（前端仅调用 `/api/imports/**`）。
- 重复端点：`backend/src/excel-import/excel-import.controller.ts:83`（`@Post('anomalies/bulk')`）
  - 原因：与 `backend/src/excel-import/excel-import.controller.ts:78-81`（`conflicts/bulk-resolve`）功能重复，前端未使用 `anomalies/bulk`。
- 前端测试配置：`frontend/vite.config.ts:21-24` 引用 `./src/test/setup.ts`
  - 原因：该文件不存在（目录 `frontend/src/test/` 缺失），将导致 `vitest` 启动失败。
- 后端测试版本不兼容：`backend/package.json:52`（`jest@^30`）与 `backend/package.json:56`（`ts-jest@^29`）
  - 原因：`ts-jest@29` 不支持 Jest 30，测试将无法运行。
- 无效脚本引用：`backend/package.json:20`（`test:e2e`）指向 `backend/test/jest-e2e.json`（缺失）
  - 原因：目录与配置文件不存在。

## 处置方案
- 删除空文件与未用资产
  - 移除 `backend/src/entities/import-conflict.entity.ts`
  - 移除 `frontend/src/typescript.svg`
- 清理与构建
  - 清空 `backend/dist/`；保留 `nest-cli.json` 的 `deleteOutDir=true`，构建自动再生成。
- 路由统一
  - 移除 `ExcelImportController` 中的 `@Post('anomalies/bulk')`，仅保留 `conflicts/bulk-resolve`（与现有前端一致）。
- 测试修复
  - 前端：删除 `vite.config.ts` 的 `setupFiles` 引用或补齐最小化 `src/test/setup.ts`
  - 后端：将 `jest` 降至 `^29` 或临时移除 `ts-jest`/测试脚本；删除失效的 `test:e2e` 脚本。
- 样板端点评估
  - 视需求删除 `AppController/AppService`；如需健康检查可改为显式 `/health`。

## 执行顺序
1. 清理 `backend/dist/` 与未用文件（保证后续构建输出干净）。
2. 路由统一（删除 `anomalies/bulk`），避免重复维护。
3. 修复测试配置（前端 `vitest` 与后端 `jest`/`ts-jest`）。
4. 评估并移除样板端点。

## 验证步骤
- 后端：`npm run build` 后检查 `dist` 无 `import-conflict.entity.*`；`npm run start:dev` 验证 `/api/imports/**` 端点可用。
- 前端：`npm run dev` 与 `vitest run` 正常；上传/历史/冲突视图工作流可用。

## 备注（代码定位）
- 重复端点：`backend/src/excel-import/excel-import.controller.ts:78-81` 与 `backend/src/excel-import/excel-import.controller.ts:83-86`
- 样板端点：`backend/src/app.controller.ts:8-11`（`getHello`）
- 测试版本：`backend/package.json:52-57`（`jest`、`ts-jest`）
- 前端测试配置：`frontend/vite.config.ts:21-24`（`setupFiles`）